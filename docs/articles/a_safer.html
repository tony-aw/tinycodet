<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tinycodet">
<title>Safer functionality • tinycodet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Serif-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Safer functionality">
<meta property="og:description" content="tinycodet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tinycodet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/tinycodet.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_safer.html">Safer functionality</a>
    <a class="dropdown-item" href="../articles/b_import_main.html">Import system - main functions</a>
    <a class="dropdown-item" href="../articles/c_import_additional.html">Import system - additional details</a>
    <a class="dropdown-item" href="../articles/d_strings_functions.html">String related functions</a>
    <a class="dropdown-item" href="../articles/e_strings_inops.html">String related infix operators</a>
    <a class="dropdown-item" href="../articles/f_DRY.html">Don't Repeat Yourself</a>
    <a class="dropdown-item" href="../articles/g_misc.html">Miscellaneous functionality</a>
    <a class="dropdown-item" href="../articles/h_otherpkgs.html">Relations to other packages</a>
    <a class="dropdown-item" href="../articles/i_benchmarks.html">Benchmarks</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tony-aw/tinycodet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Safer functionality</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tony-aw/tinycodet/blob/HEAD/../vignettes/articles/a_safer.Rmd" class="external-link"><code>../vignettes/articles/a_safer.Rmd</code></a></small>
      <div class="d-none name"><code>a_safer.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tony-aw/tinycodet/" class="external-link">tinycodet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Run `?tinycodet::tinycodet` to open the introduction help page of 'tinycodet'.</span></span></code></pre></div>
<div class="section level2">
<h2 id="decimal-inequality-testing-operators">Decimal (in)equality testing operators<a class="anchor" aria-label="anchor" href="#decimal-inequality-testing-operators"></a>
</h2>
<p>This package adds the
<code>%d==%, %d!=% %d&lt;%, %d&gt;%, %d&lt;=%, %d&gt;=%</code>
(in)equality operators, which perform safer decimal number truth
testing. They are virtually equivalent to the regular (in)equality
operators, <code>==, !=, &lt;, &gt;, &lt;=, &gt;=</code>, except for 2
aspects:</p>
<ol style="list-style-type: decimal">
<li><p>The <code>%d...%</code> operators assume that if the absolute
difference between any two numbers x and y is smaller than the Machine
tolerance, sqrt(.Machine$double.eps), then x and y should be consider to
be equal. For example: <code>0.1*7 == 0.7</code> returns
<code>FALSE</code>, even though they are equal, due to the way decimal
numbers are stored in programming languages like ‘R’ and ‘Python’. But
<code>0.1*7 %d==% 0.7</code> returns <code>TRUE</code>.</p></li>
<li><p>Only numeric input is allowed, so characters are not coerced to
numbers. I.e. <code>1 &lt; "a"</code> gives <code>TRUE</code> , whereas
<code>1 %d&lt;% "a"</code> gives an error. For character equality
testing, see %s==% from the ‘stringi’ package.</p></li>
</ol>
<p>Thus these provide safer decimal number (in)equality operators.</p>
<p>Some examples:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">*</span><span class="fl">3</span>, <span class="fl">0.1</span><span class="op">*</span><span class="fl">6</span>, <span class="fl">0.1</span><span class="op">*</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3 0.6 0.7</span></span>
<span><span class="co">#&gt; [1] 0.3 0.6 0.7</span></span>
<span><span class="va">x</span> <span class="op">==</span> <span class="va">y</span> <span class="co"># gives FALSE, but should be TRUE</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span>
<span><span class="va">x</span><span class="op">!=</span> <span class="va">y</span> <span class="co"># gives TRUE, should be FALSE</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">y</span> <span class="co"># not wrong</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span>
<span><span class="va">x</span> <span class="op">&lt;</span> <span class="va">y</span> <span class="co"># gives TRUE, should be FALSE</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d==%</a></span> <span class="va">y</span> <span class="co"># here it's done correctly</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d!=%</a></span> <span class="va">y</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d&lt;%</a></span> <span class="va">y</span> <span class="co"># correct</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d&gt;%</a></span> <span class="va">y</span> <span class="co"># correct</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d&lt;=%</a></span> <span class="va">y</span> <span class="co"># correct</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d&gt;=%</a></span> <span class="va">y</span> <span class="co"># correct</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p> </p>
<p>There are also the <code>x %d{}% bnd</code> and
<code>x %d!{}% bnd</code> operators, where <code>bnd</code> is a vector
of length 2, or a 2-column matrix
<code>(nrow(bnd)==length(x) or nrow(bnd)==1)</code>. The
<code>x %d{}% bnd</code> operator checks if <code>x</code> is within the
<strong>closed</strong> interval with bounds defined by
<code>bnd</code>. The <code>x %d!{}% bnd</code> operator checks if
<code>x</code> is outside the <strong>closed</strong> interval with
bounds defined by <code>bnd</code>.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">bnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fl">0.1</span>, <span class="va">x</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d{}%</a></span> <span class="va">bnd</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/decimal_truth.html">%d!{}%</a></span> <span class="va">bnd</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level2">
<h2 id="safer-atomic-type-casting">Safer atomic type casting<a class="anchor" aria-label="anchor" href="#safer-atomic-type-casting"></a>
</h2>
<p>Atomic type casting in R is generally performed using the functions
<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer()</a></code>,
<code><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double()</a></code>, <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code>.</p>
<p>These functions have the annoying property that they strip
attributes. I’ve taken the liberty of creating more convenient atomic
conversion functions:</p>
<ul>
<li>
<code><a href="../reference/atomic_conversions.html">as_bool()</a></code>: same as <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical()</a></code>, but with
attributes preserved.</li>
<li>
<code><a href="../reference/atomic_conversions.html">as_int()</a></code>: same as <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer()</a></code>, but with
attributes preserved.</li>
<li>
<code><a href="../reference/atomic_conversions.html">as_dbl()</a></code>: same as <code><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double()</a></code>
(i.e. convert to real numbers), but with attributes preserved.</li>
<li>
<code><a href="../reference/atomic_conversions.html">as_chr()</a></code>: same as <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code>, but with
attributes preserved.</li>
</ul>
<p>All attributes except the “class” attribute are preserved.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"test"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"test"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      one two</span></span>
<span><span class="co">#&gt; [1,] 0.0 1.0</span></span>
<span><span class="co">#&gt; [2,] 0.0 1.5</span></span>
<span><span class="co">#&gt; [3,] 0.0 2.0</span></span>
<span><span class="co">#&gt; [4,] 0.5 2.5</span></span>
<span><span class="co">#&gt; attr(,"test")</span></span>
<span><span class="co">#&gt; [1] "test"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/atomic_conversions.html">as_bool</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;        one  two</span></span>
<span><span class="co">#&gt; [1,] FALSE TRUE</span></span>
<span><span class="co">#&gt; [2,] FALSE TRUE</span></span>
<span><span class="co">#&gt; [3,] FALSE TRUE</span></span>
<span><span class="co">#&gt; [4,]  TRUE TRUE</span></span>
<span><span class="co">#&gt; attr(,"test")</span></span>
<span><span class="co">#&gt; [1] "test"</span></span>
<span><span class="fu"><a href="../reference/atomic_conversions.html">as_int</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      one two</span></span>
<span><span class="co">#&gt; [1,]   0   1</span></span>
<span><span class="co">#&gt; [2,]   0   1</span></span>
<span><span class="co">#&gt; [3,]   0   2</span></span>
<span><span class="co">#&gt; [4,]   0   2</span></span>
<span><span class="co">#&gt; attr(,"test")</span></span>
<span><span class="co">#&gt; [1] "test"</span></span>
<span><span class="fu"><a href="../reference/atomic_conversions.html">as_dbl</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      one two</span></span>
<span><span class="co">#&gt; [1,] 0.0 1.0</span></span>
<span><span class="co">#&gt; [2,] 0.0 1.5</span></span>
<span><span class="co">#&gt; [3,] 0.0 2.0</span></span>
<span><span class="co">#&gt; [4,] 0.5 2.5</span></span>
<span><span class="co">#&gt; attr(,"test")</span></span>
<span><span class="co">#&gt; [1] "test"</span></span>
<span><span class="fu"><a href="../reference/atomic_conversions.html">as_chr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      one   two  </span></span>
<span><span class="co">#&gt; [1,] "0"   "1"  </span></span>
<span><span class="co">#&gt; [2,] "0"   "1.5"</span></span>
<span><span class="co">#&gt; [3,] "0"   "2"  </span></span>
<span><span class="co">#&gt; [4,] "0.5" "2.5"</span></span>
<span><span class="co">#&gt; attr(,"test")</span></span>
<span><span class="co">#&gt; [1] "test"</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level2">
<h2 id="locked-constants">Locked constants<a class="anchor" aria-label="anchor" href="#locked-constants"></a>
</h2>
<p>One can re-assign the values <code>T</code> and <code>F</code>. One
can even run something like <code>T &lt;- FALSE</code> and
<code>F &lt;- TRUE</code>! <code>tinycodet</code> adds the
<code><a href="../reference/lock.html">lock_TF()</a></code> function that forces <code>T</code> to stay
<code>TRUE</code> and <code>F</code> to stay <code>FALSE</code>.
Essentially, the <code><a href="../reference/lock.html">lock_TF()</a></code> function creates the locked
constant <code>T</code> and <code>F</code>, assigned to
<code>TRUE</code> and <code>FALSE</code> respectively, to prevent the
user from re-assigning them. Removing the created <code>T</code> and
<code>F</code> constants allows re-assignment again.</p>
<p> </p>
<p>The <code>X %&lt;-c% A</code> operator creates a
<code>constant</code> <code>X</code> with assignment <code>A</code>.
Constants cannot be changed, only accessed or removed. So if you have a
piece of code that requires some unchangeable constant, use this
operator to create said constant.</p>
<p> </p>
</div>
<div class="section level2">
<h2 id="form">form()<a class="anchor" aria-label="anchor" href="#form"></a>
</h2>
<p>When creating a formula with the tilde (<code>⁠~</code> ⁠) operator,
and storing a formula in a variable to be used later, the environment is
captured by the formula. Therefore, any object in the captured
environment might not be freed from the memory, potentially creating
some memory leak.</p>
<p>The <code><a href="../reference/form.html">form()</a></code> function is a convenience function, to
quickly create and return/store a formula more safely, by having no
default environment, and allowing the user to specify the environment
explicitly.</p>
<p>It can also quickly convert a single string to a formula, again
allowing for explicit environment specification, and having no
environment by default.</p>
<p>See the benchmark article for a demonstration of the memory leak.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># see also http://adv-r.had.co.nz/memory.html</span></span>
<span></span>
<span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">foo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">LETTERS</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu">f1</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># empty, since no formula is used inside f1(), so safe</span></span>
<span><span class="co">#&gt; list()</span></span>
<span></span>
<span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">foo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">LETTERS</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">~</span> <span class="va">b</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu">f2</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># NOT safe: contains all objects from f2()</span></span>
<span><span class="co">#&gt; $out</span></span>
<span><span class="co">#&gt; a ~ b</span></span>
<span><span class="co">#&gt; &lt;environment: 0x000001b72106bcd0&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $foo</span></span>
<span><span class="co">#&gt;  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"</span></span>
<span><span class="co">#&gt; [20] "t" "u" "v" "w" "x" "y" "z" "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L"</span></span>
<span><span class="co">#&gt; [39] "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"foo"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span> <span class="co"># = TRUE: "foo" still exists!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">$</span><span class="va">foo</span> <span class="co"># can still access it; probably won't be removed by gc()</span></span>
<span><span class="co">#&gt;  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"</span></span>
<span><span class="co">#&gt; [20] "t" "u" "v" "w" "x" "y" "z" "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L"</span></span>
<span><span class="co">#&gt; [39] "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</span></span>
<span></span>
<span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">foo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">LETTERS</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="va">a</span> <span class="op">~</span> <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu">f3</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># empty, since form() is used, so safe</span></span>
<span><span class="co">#&gt; list()</span></span>
<span></span>
<span></span>
<span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">foo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">LETTERS</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="st">"a ~ b"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu">f4</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">x4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># empty, since form() is used, so safe</span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level2">
<h2 id="with_pro-and-aes_pro">with_pro and aes_pro<a class="anchor" aria-label="anchor" href="#with_pro-and-aes_pro"></a>
</h2>
<p>‘tinycodet’ provides standard-evaluated versions of the common
quoting functions <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>:
<code><a href="../reference/pro.html">with_pro()</a></code> and <code><a href="../reference/pro.html">aes_pro()</a></code>, respectively.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: ggplot2</span></span>
<span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data.html">import_data</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"mpg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mutate data:</span></span>
<span><span class="va">myform</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="op">~</span> <span class="va">displ</span> <span class="op">+</span> <span class="va">cyl</span> <span class="op">+</span> <span class="va">cty</span> <span class="op">+</span> <span class="va">hwy</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">mysum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pro.html">with_pro</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">myform</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt;  manufacturer          model               displ            year     </span></span>
<span><span class="co">#&gt;  Length:234         Length:234         Min.   :1.600   Min.   :1999  </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Median :3.300   Median :2004  </span></span>
<span><span class="co">#&gt;                                        Mean   :3.472   Mean   :2004  </span></span>
<span><span class="co">#&gt;                                        3rd Qu.:4.600   3rd Qu.:2008  </span></span>
<span><span class="co">#&gt;                                        Max.   :7.000   Max.   :2008  </span></span>
<span><span class="co">#&gt;       cyl           trans               drv                 cty       </span></span>
<span><span class="co">#&gt;  Min.   :4.000   Length:234         Length:234         Min.   : 9.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  </span></span>
<span><span class="co">#&gt;  Median :6.000   Mode  :character   Mode  :character   Median :17.00  </span></span>
<span><span class="co">#&gt;  Mean   :5.889                                         Mean   :16.86  </span></span>
<span><span class="co">#&gt;  3rd Qu.:8.000                                         3rd Qu.:19.00  </span></span>
<span><span class="co">#&gt;  Max.   :8.000                                         Max.   :35.00  </span></span>
<span><span class="co">#&gt;       hwy             fl               class               mysum      </span></span>
<span><span class="co">#&gt;  Min.   :12.00   Length:234         Length:234         Min.   :33.70  </span></span>
<span><span class="co">#&gt;  1st Qu.:18.00   Class :character   Class :character   1st Qu.:43.10  </span></span>
<span><span class="co">#&gt;  Median :24.00   Mode  :character   Mode  :character   Median :50.15  </span></span>
<span><span class="co">#&gt;  Mean   :23.44                                         Mean   :49.66  </span></span>
<span><span class="co">#&gt;  3rd Qu.:27.00                                         3rd Qu.:54.08  </span></span>
<span><span class="co">#&gt;  Max.   :44.00                                         Max.   :84.90</span></span>
<span></span>
<span><span class="co"># plotting data:</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="st">"cty"</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form.html">form</a></span><span class="op">(</span><span class="op">~</span> <span class="va">drv</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="../reference/pro.html">aes_pro</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_safer_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p> </p>
</div>
<div class="section level2">
<h2 id="safer-partial-matching">Safer Partial Matching<a class="anchor" aria-label="anchor" href="#safer-partial-matching"></a>
</h2>
<p>The <code><a href="../reference/safer_partialmatch.html">safer_partialmatch()</a></code> forces ‘R’ to give a warning
when partial matching occurs when using the dollar ($) operator, or when
other forms of partial matching occurs. It simply calls the
following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>   warnPartialMatchDollar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>   warnPartialMatchArgs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>   warnPartialMatchAttr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tony Wilkes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
