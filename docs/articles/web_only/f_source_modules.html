<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tinyoperations">
<title>Source modules • tinyoperations</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Source modules">
<meta property="og:description" content="tinyoperations">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">tinyoperations</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web_only/a_decimal_truth.html">Safer decimal (in)equality testing</a>
    <a class="dropdown-item" href="../../articles/web_only/b_strings_functions.html">String related functions</a>
    <a class="dropdown-item" href="../../articles/web_only/c_strings_inops.html">String related infix operators</a>
    <a class="dropdown-item" href="../../articles/web_only/d_DRY.html">Don't Repeat Yourself</a>
    <a class="dropdown-item" href="../../articles/web_only/e_import_pkgs.html">Package import system</a>
    <a class="dropdown-item" href="../../articles/web_only/f_source_modules.html">Source modules</a>
    <a class="dropdown-item" href="../../articles/web_only/g_misc.html">Miscellaneous functionality</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tony-aw/tinyoperations/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Source modules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tony-aw/tinyoperations/blob/HEAD/../vignettes/web_only/f_source_modules.Rmd" class="external-link"><code>../vignettes/web_only/f_source_modules.Rmd</code></a></small>
      <div class="d-none name"><code>f_source_modules.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tony-aw/tinyoperations" class="external-link">tinyoperations</a></span><span class="op">)</span></span></code></pre></div>
<p> </p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The article “Package import system” explained the new import system
introduced by the <code>tinyoperations</code> R package. Some of its
functionality is also extended to work on scripts that provide
user-defined functions and datasets. These scripts, which should have no
side-effects (i.e. plots, prints, messages), are referred to as
“modules”.</p>
<p> </p>
</div>
<div class="section level2">
<h2 id="main">Main<a class="anchor" aria-label="anchor" href="#main"></a>
</h2>
<p>The the <code>tinyoperations</code> R package adds the
<code>alias %@source% list(file=...)</code> operator and the
<code><a href="../../reference/source_module.html">source_inops()</a></code> function. The
<code>alias %@source% list(file=...)</code> operator sources a script
and returns all the objects in the script under an <code>alias</code>,
similar to <code><a href="../../reference/import_as.html">import_as()</a></code>. The <code><a href="../../reference/source_module.html">source_inops()</a></code>
function sources a script and places all infix operators in the script
(if any) in the current environment (like the Global environment, or the
environment within a function), similar to
<code><a href="../../reference/import_inops.html">import_inops()</a></code>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myalias.</span> <span class="op"><a href="../../reference/source_module.html">%@source%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"sourcetest.R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing module ...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the sourced objects using `myalias.$`.</span></span>
<span><span class="fu"><a href="../../reference/source_module.html">source_inops</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"sourcetest.R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; placing operators in current environment...</span></span>
<span></span>
<span><span class="va">myalias.</span><span class="op">$</span><span class="fu">helloworld</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "hello world"</span></span></code></pre></div>
<p>Another example, this time using an expression:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">helloworld</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"helloworld"</span><span class="op">)</span></span>
<span>  <span class="va">goodbyeworld</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"goodbye world"</span><span class="op">)</span></span>
<span>  <span class="va">`%s+test%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu">`%s+%`</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">`%s*test%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu">`%s*%`</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myalias.</span> <span class="op"><a href="../../reference/source_module.html">%@source%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing module ...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the sourced objects using `myalias.$`.</span></span>
<span></span>
<span><span class="va">myalias.</span><span class="op">$</span><span class="fu">helloworld</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "helloworld"</span></span>
<span></span>
<span><span class="va">temp.fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../../reference/source_module.html">source_inops</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span> <span class="co"># places the function inside the function environment</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># list all objects residing within the function definition</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">temp.fun</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; placing operators in current environment...</span></span>
<span><span class="co">#&gt; [1] "%s*test%" "%s+test%"</span></span></code></pre></div>
<p> </p>
<p>Note that, as long as <code>@source</code> and
<code><a href="../../reference/source_module.html">source_inops()</a></code> <strong>source the same
file/expression</strong>, they will both have access to the same
functions.</p>
<p>To demonstrate this, consider the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">mypaste</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu">`%s+%`</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">`%s+test%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">mypaste</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="co"># notice this operator needs to "see" mypaste() in order to work.</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">myalias.</span> <span class="op"><a href="../../reference/source_module.html">%@source%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing module ...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the sourced objects using `myalias.$`.</span></span>
<span><span class="fu"><a href="../../reference/source_module.html">source_inops</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span></span>
<span><span class="co">#&gt; placing operators in current environment...</span></span>
<span><span class="st">"a"</span> <span class="op">%s+test%</span> <span class="st">"b"</span></span>
<span><span class="co">#&gt; [1] "ab"</span></span>
<span></span>
<span><span class="co"># both the aliased functions and the exposed infix operator</span></span>
<span><span class="co"># have access to the same functions:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">`%s+test%`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "%s+test%" "mypaste"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">myalias.</span><span class="op">$</span><span class="va">mypaste</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "%s+test%" "mypaste"</span></span></code></pre></div>
<p>So no need to worry about their scope (unless you start tinkering
with the environments of the functions.)</p>
<p> </p>
</div>
<div class="section level2">
<h2 id="the-report_inops-function">The report_inops() function<a class="anchor" aria-label="anchor" href="#the-report_inops-function"></a>
</h2>
<p><code>tinyoperations</code> adds the <code><a href="../../reference/report_inops.html">report_inops()</a></code>
function. This is a convenience function that prints all infix operators
in the current environment, as well as from which package it came (if
the function can find that out), and whether the function is locked or
not.</p>
<p>Example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/import_inops.html">import_inops</a></span><span class="op">(</span><span class="st">"magrittr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting infix operators from package: magrittr...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking for conflicting infix operators in the current environment...</span></span>
<span><span class="co">#&gt; Placing infix operators in current environment...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">helloworld</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"helloworld"</span><span class="op">)</span></span>
<span>  <span class="va">goodbyeworld</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"goodbye world"</span><span class="op">)</span></span>
<span>  <span class="va">`%s+test%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu">`%s+%`</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">`%s*test%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu">`%s*%`</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/source_module.html">source_inops</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span></span>
<span><span class="co">#&gt; placing operators in current environment...</span></span>
<span><span class="fu"><a href="../../reference/report_inops.html">report_inops</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   infix_operator  package</span></span>
<span><span class="co">#&gt; 1           %!&gt;% magrittr</span></span>
<span><span class="co">#&gt; 2            %$% magrittr</span></span>
<span><span class="co">#&gt; 3           %&lt;&gt;% magrittr</span></span>
<span><span class="co">#&gt; 4            %&gt;% magrittr</span></span>
<span><span class="co">#&gt; 5       %s*test%     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6       %s+test%     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7           %T&gt;% magrittr</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level2">
<h2 id="regarding-s3-methods">Regarding S3 methods<a class="anchor" aria-label="anchor" href="#regarding-s3-methods"></a>
</h2>
<p>When importing packages with <code>tinyoperations</code>’ import
system, S3 methods will work just fine. For example, the S3 method ”
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> ” works on the pre-installed recommended R package
<code>mgcv</code>, even when loaded in an alias:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/import_as.html">import_as</a></span><span class="op">(</span><span class="va">mgcv.</span>, <span class="st">"mgcv"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing packages...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the functions using `mgcv.$`.</span></span>
<span><span class="co">#&gt; (S3)methods will work like normally. </span></span>
<span><span class="co">#&gt; For conflicts report and package order, run `mgcv.$.__attributes__.`.</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/import_data.html">import_data</a></span><span class="op">(</span><span class="st">"chicago"</span>, <span class="st">"gamair"</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">mgcv.</span><span class="op">$</span><span class="fu">gam</span><span class="op">(</span><span class="va">death</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">o3median</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span> <span class="co"># just a random model for the sake of demonstration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/isS3method.html" class="external-link">isS3method</a></span><span class="op">(</span>f<span class="op">=</span><span class="st">"plot"</span>, class<span class="op">=</span><span class="st">"gam"</span><span class="op">)</span> <span class="co"># this is an S3 method</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="f_source_modules_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Also, S3 methods defined in the package will automatically be
registered, and thus automatically work. For example, the following code
just works:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/import_as.html">import_as</a></span><span class="op">(</span><span class="va">dr.</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing packages...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the functions using `dr.$`.</span></span>
<span><span class="co">#&gt; (S3)methods will work like normally. </span></span>
<span><span class="co">#&gt; For conflicts report and package order, run `dr.$.__attributes__.`.</span></span>
<span><span class="fu"><a href="../../reference/import_inops.html">import_inops</a></span><span class="op">(</span><span class="st">"magrittr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting infix operators from package: magrittr...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking for conflicting infix operators in the current environment...</span></span>
<span><span class="co">#&gt; ALL prepared infix operators already exist in the current environment</span></span>
<span><span class="co">#&gt; Overwriting existing infix operators...</span></span>
<span><span class="co">#&gt; Warning in import_inops("magrittr"): ALL prepared infix operators already exist in the current environment</span></span>
<span><span class="co">#&gt; Attempted overwrite existing infix operators</span></span>
<span><span class="co">#&gt; Placing infix operators in current environment...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/import_data.html">import_data</a></span><span class="op">(</span><span class="st">"starwars"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">dr.</span><span class="op">$</span><span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/isS3method.html" class="external-link">isS3method</a></span><span class="op">(</span>f<span class="op">=</span><span class="st">"arrange"</span>, class<span class="op">=</span><span class="st">"data.frame"</span>, envir <span class="op">=</span> <span class="va">dr.</span><span class="op">)</span> <span class="co"># this is an S3 method</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/isS3method.html" class="external-link">isS3method</a></span><span class="op">(</span>f<span class="op">=</span><span class="st">"relocate"</span>, class<span class="op">=</span><span class="st">"data.frame"</span>, envir <span class="op">=</span> <span class="va">dr.</span><span class="op">)</span> <span class="co"># this is an S3 method</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># this works:</span></span>
<span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">dr.</span><span class="op">$</span><span class="fu">arrange</span><span class="op">(</span><span class="va">dr.</span><span class="op">$</span><span class="fu">desc</span><span class="op">(</span><span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">dr.</span><span class="op">$</span><span class="fu">relocate</span><span class="op">(</span><span class="va">species</span>, <span class="va">mass</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 87 × 14</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   species [38]</span></span></span>
<span><span class="co">#&gt;    species    mass name  height hair_color skin_color eye_color birth_year sex  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Hutt       <span style="text-decoration: underline;">1</span>358 Jabb…    175 <span style="color: #BB0000;">NA</span>         green-tan… orange         600   herm…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Kaleesh     159 Grie…    216 none       brown, wh… green, y…       <span style="color: #BB0000;">NA</span>   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Droid       140 IG-88    200 none       metal      red             15   none </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Human       136 Dart…    202 none       white      yellow          41.9 male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Wookiee     136 Tarf…    234 brown      brown      blue            <span style="color: #BB0000;">NA</span>   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Human       120 Owen…    178 brown, gr… light      blue            52   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Trandosh…   113 Bossk    190 none       green      red             53   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Wookiee     112 Chew…    228 brown      unknown    blue           200   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Human       110 Jek …    180 brown      fair       blue            <span style="color: #BB0000;">NA</span>   male </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Besalisk    102 Dext…    198 none       brown      yellow          <span style="color: #BB0000;">NA</span>   male </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 77 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, films &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   vehicles &lt;list&gt;, starships &lt;list&gt;</span></span></span></code></pre></div>
<p>So when importing packages, everything works as expected, including
S3 methods.</p>
<p> </p>
<p>So for packages, there’s no need to worry about S3 methods. This is
unfortunately not the case for most simple scripts that users create
themselves, as simple scripts usually do not register S3 methods outside
of the script’s own environment.</p>
<p>The following code, for example, gives an error:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">mymeth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod</a></span><span class="op">(</span><span class="st">"mymeth"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">mymeth.numeric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span> <span class="op">*</span><span class="fl">2</span></span>
<span>  </span>
<span>  <span class="va">mymeth.character</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">chartr</a></span><span class="op">(</span><span class="va">x</span>, old <span class="op">=</span> <span class="st">"a-zA-Z"</span>, new <span class="op">=</span> <span class="st">"A-Za-z"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myalias.</span> <span class="op"><a href="../../reference/source_module.html">%@source%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exprs<span class="op">=</span><span class="va">exprs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing module ...</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; You can now access the sourced objects using `myalias.$`.</span></span>
<span></span>
<span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/expect_equal.html" class="external-link">expect_error</a></span><span class="op">(</span><span class="va">myalias.</span><span class="op">$</span><span class="fu">mymeth</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span><span class="co">#&gt;  call| tinytest::expect_error(myalias.$mymeth(0))</span></span>
<span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/expect_equal.html" class="external-link">expect_error</a></span><span class="op">(</span><span class="va">myalias.</span><span class="op">$</span><span class="fu">mymeth</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span><span class="co">#&gt;  call| tinytest::expect_error(myalias.$mymeth("a"))</span></span></code></pre></div>
<p>The <code>tinyoperations</code> R package does not provide support
for registering S3 methods from sourced scripts, at least not out of the
box.</p>
<p>The solution is quite simple though: If you have your own script
containing S3/S4 methods, put all methods, and all functions that
interact with said methods, in their own script, and source them using
the regular <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">mymeth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod</a></span><span class="op">(</span><span class="st">"mymeth"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">mymeth.numeric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span> <span class="op">*</span><span class="fl">2</span></span>
<span>  </span>
<span>  <span class="va">mymeth.character</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">chartr</a></span><span class="op">(</span><span class="va">x</span>, old <span class="op">=</span> <span class="st">"a-zA-Z"</span>, new <span class="op">=</span> <span class="st">"A-Za-z"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>exprs <span class="op">=</span> <span class="va">exprs</span><span class="op">)</span></span>
<span><span class="fu">mymeth</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu">mymeth</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A"</span></span></code></pre></div>
<p>If you dislike this approach, you can also use the <a href="https://github.com/rticulate/import" class="external-link">import</a> package to source
a script, as that package provides an (experimental) S3 registering
system for sourced scripts. Note, however, that the <a href="https://github.com/rticulate/import" class="external-link">import</a> R package does not
provide some of the other features of <code>tinyoperations</code>, such
as importing multiple related packages under the same alias, and
convenient infix operator handling.</p>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tony Wilkes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
